{"ast":null,"code":"import { apiRequest } from './utils';\n// Transform API user to our User type\nconst transformUser = apiUser => ({\n  id: apiUser.id,\n  username: apiUser.username,\n  email: `${apiUser.username}@example.com`,\n  // Placeholder email since it's required\n  status: apiUser.status || 'offline',\n  avatar: undefined // Optional field\n});\nexport const getChannels = async () => {\n  console.log('Fetching channels...');\n  try {\n    // All channels are accessible by default to all users\n    const channels = await apiRequest('/channels');\n    console.log('Received channels:', channels);\n    return channels;\n  } catch (error) {\n    console.error('Error fetching channels:', error);\n    throw error;\n  }\n};\nexport const getChannelMessages = async (channelId, limit = 50, skip = 0) => {\n  console.log(`Fetching messages for channel ${channelId} with limit ${limit} and skip ${skip}...`);\n  try {\n    if (!channelId || channelId <= 0) {\n      throw new Error('Invalid channel ID');\n    }\n    if (limit <= 0) {\n      throw new Error('Invalid limit value');\n    }\n    if (skip < 0) {\n      throw new Error('Invalid skip value');\n    }\n    const messages = await apiRequest(`/channels/${channelId}/messages?limit=${limit}&skip=${skip}`);\n    console.log('Received messages:', messages);\n\n    // Validate and transform messages\n    const validMessages = messages.filter(msg => msg && msg.id && msg.content && msg.channel_id && msg.sender_id).map(msg => ({\n      id: Number(msg.id),\n      content: msg.content,\n      channel_id: Number(msg.channel_id),\n      sender_id: Number(msg.sender_id),\n      created_at: msg.created_at || new Date().toISOString(),\n      is_system: msg.is_system || false\n    }));\n    console.log('Validated and transformed messages:', validMessages);\n    return validMessages;\n  } catch (error) {\n    console.error(`Error fetching messages for channel ${channelId}:`, error);\n    throw error;\n  }\n};\nexport const getChannelUsers = async channelId => {\n  console.log(`Fetching users for channel ${channelId}...`);\n  try {\n    const apiUsers = await apiRequest(`/channels/${channelId}/members`);\n    console.log('Received users:', apiUsers);\n    const users = apiUsers.map(transformUser);\n    console.log('Transformed users:', users);\n    return users;\n  } catch (error) {\n    console.error(`Error fetching users for channel ${channelId}:`, error);\n    throw error;\n  }\n};\nexport const createChannel = async (name, description) => {\n  console.log('Creating channel:', {\n    name,\n    description\n  });\n  try {\n    const channel = await apiRequest('/channels', {\n      method: 'POST',\n      body: JSON.stringify({\n        name,\n        description\n      })\n    });\n    console.log('Created channel:', channel);\n    return channel;\n  } catch (error) {\n    console.error('Error creating channel:', error);\n    throw error;\n  }\n};\nexport const joinChannel = async channelId => {\n  console.log(`Joining channel ${channelId}...`);\n  try {\n    // All channels are accessible by default, this is just to sync the user's presence\n    await apiRequest(`/channels/${channelId}/join`, {\n      method: 'POST'\n    });\n    console.log(`Joined channel ${channelId}`);\n  } catch (error) {\n    // Even if joining fails, the user can still view the channel\n    console.error(`Error joining channel ${channelId}:`, error);\n    console.warn('User can still view channel messages despite join error');\n  }\n};\nexport const leaveChannel = async channelId => {\n  console.log(`Leaving channel ${channelId}...`);\n  try {\n    await apiRequest(`/channels/${channelId}/leave`, {\n      method: 'POST'\n    });\n    console.log(`Left channel ${channelId}`);\n  } catch (error) {\n    console.error(`Error leaving channel ${channelId}:`, error);\n    throw error;\n  }\n};","map":{"version":3,"names":["apiRequest","transformUser","apiUser","id","username","email","status","avatar","undefined","getChannels","console","log","channels","error","getChannelMessages","channelId","limit","skip","Error","messages","validMessages","filter","msg","content","channel_id","sender_id","map","Number","created_at","Date","toISOString","is_system","getChannelUsers","apiUsers","users","createChannel","name","description","channel","method","body","JSON","stringify","joinChannel","warn","leaveChannel"],"sources":["Z:/GAUNTLET/projects/SERMO/sermo-app/frontend/src/services/api/chat.ts"],"sourcesContent":["import { Channel, Message, User } from '../../types';\nimport { apiRequest } from './utils';\n\ninterface ApiUser {\n  id: string;\n  username: string;\n  status: 'online' | 'offline' | 'away' | 'busy';\n  last_seen: string;\n}\n\n// Transform API user to our User type\nconst transformUser = (apiUser: ApiUser): User => ({\n  id: apiUser.id,\n  username: apiUser.username,\n  email: `${apiUser.username}@example.com`, // Placeholder email since it's required\n  status: apiUser.status || 'offline',\n  avatar: undefined // Optional field\n});\n\nexport const getChannels = async (): Promise<Channel[]> => {\n  console.log('Fetching channels...');\n  try {\n    // All channels are accessible by default to all users\n    const channels = await apiRequest<Channel[]>('/channels');\n    console.log('Received channels:', channels);\n    return channels;\n  } catch (error) {\n    console.error('Error fetching channels:', error);\n    throw error;\n  }\n};\n\nexport const getChannelMessages = async (channelId: number, limit: number = 50, skip: number = 0): Promise<Message[]> => {\n  console.log(`Fetching messages for channel ${channelId} with limit ${limit} and skip ${skip}...`);\n  try {\n    if (!channelId || channelId <= 0) {\n      throw new Error('Invalid channel ID');\n    }\n\n    if (limit <= 0) {\n      throw new Error('Invalid limit value');\n    }\n\n    if (skip < 0) {\n      throw new Error('Invalid skip value');\n    }\n\n    const messages = await apiRequest<Message[]>(`/channels/${channelId}/messages?limit=${limit}&skip=${skip}`);\n    console.log('Received messages:', messages);\n\n    // Validate and transform messages\n    const validMessages = messages\n      .filter(msg => msg && msg.id && msg.content && msg.channel_id && msg.sender_id)\n      .map(msg => ({\n        id: Number(msg.id),\n        content: msg.content,\n        channel_id: Number(msg.channel_id),\n        sender_id: Number(msg.sender_id),\n        created_at: msg.created_at || new Date().toISOString(),\n        is_system: msg.is_system || false\n      }));\n\n    console.log('Validated and transformed messages:', validMessages);\n    return validMessages;\n  } catch (error) {\n    console.error(`Error fetching messages for channel ${channelId}:`, error);\n    throw error;\n  }\n};\n\nexport const getChannelUsers = async (channelId: number): Promise<User[]> => {\n  console.log(`Fetching users for channel ${channelId}...`);\n  try {\n    const apiUsers = await apiRequest<ApiUser[]>(`/channels/${channelId}/members`);\n    console.log('Received users:', apiUsers);\n    const users = apiUsers.map(transformUser);\n    console.log('Transformed users:', users);\n    return users;\n  } catch (error) {\n    console.error(`Error fetching users for channel ${channelId}:`, error);\n    throw error;\n  }\n};\n\nexport const createChannel = async (name: string, description?: string): Promise<Channel> => {\n  console.log('Creating channel:', { name, description });\n  try {\n    const channel = await apiRequest<Channel>('/channels', {\n      method: 'POST',\n      body: JSON.stringify({ name, description }),\n    });\n    console.log('Created channel:', channel);\n    return channel;\n  } catch (error) {\n    console.error('Error creating channel:', error);\n    throw error;\n  }\n};\n\nexport const joinChannel = async (channelId: number): Promise<void> => {\n  console.log(`Joining channel ${channelId}...`);\n  try {\n    // All channels are accessible by default, this is just to sync the user's presence\n    await apiRequest(`/channels/${channelId}/join`, {\n      method: 'POST',\n    });\n    console.log(`Joined channel ${channelId}`);\n  } catch (error) {\n    // Even if joining fails, the user can still view the channel\n    console.error(`Error joining channel ${channelId}:`, error);\n    console.warn('User can still view channel messages despite join error');\n  }\n};\n\nexport const leaveChannel = async (channelId: number): Promise<void> => {\n  console.log(`Leaving channel ${channelId}...`);\n  try {\n    await apiRequest(`/channels/${channelId}/leave`, {\n      method: 'POST',\n    });\n    console.log(`Left channel ${channelId}`);\n  } catch (error) {\n    console.error(`Error leaving channel ${channelId}:`, error);\n    throw error;\n  }\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}