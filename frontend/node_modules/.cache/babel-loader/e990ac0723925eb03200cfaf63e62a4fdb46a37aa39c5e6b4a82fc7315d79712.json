{"ast":null,"code":"var _jsxFileName = \"Z:\\\\GAUNTLET\\\\projects\\\\SERMO\\\\sermo-app\\\\frontend\\\\src\\\\components\\\\chat\\\\MessageReplies\\\\index.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport styled from 'styled-components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Message from '../Message';\nimport { deleteMessage as deleteMessageAction, setReplies } from '../../../store/messages/messagesSlice';\nimport { deleteMessage as deleteMessageApi, getReplies } from '../../../services/api/chat';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RepliesContainer = styled.div`\n  margin-left: 32px;\n  padding-left: 16px;\n  border-left: 2px solid ${props => props.theme.colors.border};\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n`;\n_c = RepliesContainer;\nconst ReplyWrapper = styled.div`\n  position: relative;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    left: -16px;\n    top: 50%;\n    width: 12px;\n    height: 2px;\n    background-color: ${props => props.theme.colors.border};\n  }\n`;\n_c2 = ReplyWrapper;\nconst MessageReplies = ({\n  parentId\n}) => {\n  _s();\n  const dispatch = useDispatch();\n  const {\n    replies,\n    users,\n    currentUser,\n    activeChannelId\n  } = useSelector(state => ({\n    replies: Object.values(state.messages.messagesByChannel).flat().filter(msg => msg.parentId === parentId).sort((a, b) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime()),\n    users: state.chat.users,\n    currentUser: state.auth.user,\n    activeChannelId: state.chat.activeChannelId\n  }));\n  useEffect(() => {\n    const loadReplies = async () => {\n      if (!activeChannelId) return;\n      try {\n        const fetchedReplies = await getReplies(parentId);\n        // Transform the replies to match our store format\n        const transformedReplies = fetchedReplies.map(reply => ({\n          id: reply.id.toString(),\n          content: reply.content,\n          channelId: reply.channel_id.toString(),\n          userId: reply.sender_id.toString(),\n          reactions: [],\n          attachments: [],\n          createdAt: reply.created_at,\n          updatedAt: reply.created_at,\n          parentId: parentId,\n          replyCount: 0,\n          isExpanded: false\n        }));\n        dispatch(setReplies({\n          channelId: activeChannelId,\n          messageId: parentId,\n          replies: transformedReplies\n        }));\n      } catch (error) {\n        console.error('Error loading replies:', error);\n      }\n    };\n    loadReplies();\n  }, [parentId, activeChannelId, dispatch]);\n  const handleDelete = async messageId => {\n    if (!activeChannelId) return;\n    try {\n      await deleteMessageApi(messageId);\n      dispatch(deleteMessageAction({\n        channelId: activeChannelId,\n        messageId\n      }));\n    } catch (error) {\n      console.error('Error deleting reply:', error);\n    }\n  };\n  const handleToggleReplies = () => {\n    // No-op for replies\n  };\n  const handleReply = () => {\n    // No-op for replies\n  };\n  if (replies.length === 0) return null;\n  return /*#__PURE__*/_jsxDEV(RepliesContainer, {\n    children: replies.map(reply => {\n      var _users$reply$userId;\n      return /*#__PURE__*/_jsxDEV(ReplyWrapper, {\n        children: /*#__PURE__*/_jsxDEV(Message, {\n          content: reply.content,\n          sender: ((_users$reply$userId = users[reply.userId]) === null || _users$reply$userId === void 0 ? void 0 : _users$reply$userId.username) || reply.userId,\n          timestamp: reply.createdAt,\n          userId: reply.userId,\n          currentUserId: currentUser === null || currentUser === void 0 ? void 0 : currentUser.id,\n          onDelete: () => handleDelete(reply.id),\n          replyCount: 0,\n          isExpanded: false,\n          onToggleReplies: handleToggleReplies,\n          onReply: handleReply,\n          isReply: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 11\n        }, this)\n      }, reply.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 9\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }, this);\n};\n_s(MessageReplies, \"rs3c9HhD7XmndDQLccs/0ieaV+g=\", false, function () {\n  return [useDispatch, useSelector];\n});\n_c3 = MessageReplies;\nexport default MessageReplies;\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"RepliesContainer\");\n$RefreshReg$(_c2, \"ReplyWrapper\");\n$RefreshReg$(_c3, \"MessageReplies\");","map":{"version":3,"names":["React","useEffect","styled","useSelector","useDispatch","Message","deleteMessage","deleteMessageAction","setReplies","deleteMessageApi","getReplies","jsxDEV","_jsxDEV","RepliesContainer","div","props","theme","colors","border","_c","ReplyWrapper","_c2","MessageReplies","parentId","_s","dispatch","replies","users","currentUser","activeChannelId","state","Object","values","messages","messagesByChannel","flat","filter","msg","sort","a","b","Date","createdAt","getTime","chat","auth","user","loadReplies","fetchedReplies","transformedReplies","map","reply","id","toString","content","channelId","channel_id","userId","sender_id","reactions","attachments","created_at","updatedAt","replyCount","isExpanded","messageId","error","console","handleDelete","handleToggleReplies","handleReply","length","children","_users$reply$userId","sender","username","timestamp","currentUserId","onDelete","onToggleReplies","onReply","isReply","fileName","_jsxFileName","lineNumber","columnNumber","_c3","$RefreshReg$"],"sources":["Z:/GAUNTLET/projects/SERMO/sermo-app/frontend/src/components/chat/MessageReplies/index.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport styled from 'styled-components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { StoreMessage, RootState } from '../../../types';\nimport Message from '../Message';\nimport { deleteMessage as deleteMessageAction, setReplies } from '../../../store/messages/messagesSlice';\nimport { deleteMessage as deleteMessageApi, getReplies } from '../../../services/api/chat';\n\ninterface MessageRepliesProps {\n  parentId: string;\n}\n\nconst RepliesContainer = styled.div`\n  margin-left: 32px;\n  padding-left: 16px;\n  border-left: 2px solid ${props => props.theme.colors.border};\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n`;\n\nconst ReplyWrapper = styled.div`\n  position: relative;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    left: -16px;\n    top: 50%;\n    width: 12px;\n    height: 2px;\n    background-color: ${props => props.theme.colors.border};\n  }\n`;\n\nconst MessageReplies: React.FC<MessageRepliesProps> = ({ parentId }) => {\n  const dispatch = useDispatch();\n  const { replies, users, currentUser, activeChannelId } = useSelector((state: RootState) => ({\n    replies: Object.values(state.messages.messagesByChannel)\n      .flat()\n      .filter((msg: StoreMessage) => msg.parentId === parentId)\n      .sort((a, b) => new Date(a.createdAt).getTime() - new Date(b.createdAt).getTime()),\n    users: state.chat.users,\n    currentUser: state.auth.user,\n    activeChannelId: state.chat.activeChannelId\n  }));\n\n  useEffect(() => {\n    const loadReplies = async () => {\n      if (!activeChannelId) return;\n      \n      try {\n        const fetchedReplies = await getReplies(parentId);\n        // Transform the replies to match our store format\n        const transformedReplies = fetchedReplies.map(reply => ({\n          id: reply.id.toString(),\n          content: reply.content,\n          channelId: reply.channel_id.toString(),\n          userId: reply.sender_id.toString(),\n          reactions: [],\n          attachments: [],\n          createdAt: reply.created_at,\n          updatedAt: reply.created_at,\n          parentId: parentId,\n          replyCount: 0,\n          isExpanded: false\n        }));\n        \n        dispatch(setReplies({\n          channelId: activeChannelId,\n          messageId: parentId,\n          replies: transformedReplies\n        }));\n      } catch (error) {\n        console.error('Error loading replies:', error);\n      }\n    };\n\n    loadReplies();\n  }, [parentId, activeChannelId, dispatch]);\n\n  const handleDelete = async (messageId: string) => {\n    if (!activeChannelId) return;\n    \n    try {\n      await deleteMessageApi(messageId);\n      dispatch(deleteMessageAction({ channelId: activeChannelId, messageId }));\n    } catch (error) {\n      console.error('Error deleting reply:', error);\n    }\n  };\n\n  const handleToggleReplies = () => {\n    // No-op for replies\n  };\n\n  const handleReply = () => {\n    // No-op for replies\n  };\n\n  if (replies.length === 0) return null;\n\n  return (\n    <RepliesContainer>\n      {replies.map((reply) => (\n        <ReplyWrapper key={reply.id}>\n          <Message\n            content={reply.content}\n            sender={users[reply.userId]?.username || reply.userId}\n            timestamp={reply.createdAt}\n            userId={reply.userId}\n            currentUserId={currentUser?.id}\n            onDelete={() => handleDelete(reply.id)}\n            replyCount={0}\n            isExpanded={false}\n            onToggleReplies={handleToggleReplies}\n            onReply={handleReply}\n            isReply={true}\n          />\n        </ReplyWrapper>\n      ))}\n    </RepliesContainer>\n  );\n};\n\nexport default MessageReplies; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}