{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nconst initialState = {};\nconst messagesSlice = createSlice({\n  name: 'messages',\n  initialState,\n  reducers: {\n    setMessages: (state, action) => {\n      const {\n        channelId,\n        messages\n      } = action.payload;\n      state[channelId] = messages;\n    },\n    addMessage: (state, action) => {\n      const {\n        channelId,\n        message\n      } = action.payload;\n      if (!state[channelId]) {\n        state[channelId] = [];\n      }\n      state[channelId].push(message);\n    },\n    prependMessages: (state, action) => {\n      const {\n        channelId,\n        messages\n      } = action.payload;\n      if (!state[channelId]) {\n        state[channelId] = [];\n      }\n      state[channelId].unshift(...messages);\n    },\n    updateMessage: (state, action) => {\n      var _state$channelId;\n      const {\n        channelId,\n        messageId,\n        message\n      } = action.payload;\n      const messageIndex = (_state$channelId = state[channelId]) === null || _state$channelId === void 0 ? void 0 : _state$channelId.findIndex(m => m.id === messageId);\n      if (messageIndex !== undefined && messageIndex !== -1) {\n        state[channelId][messageIndex] = {\n          ...state[channelId][messageIndex],\n          ...message\n        };\n      }\n    },\n    deleteMessage: (state, action) => {\n      const {\n        channelId,\n        messageId\n      } = action.payload;\n      if (state[channelId]) {\n        state[channelId] = state[channelId].filter(message => message.id !== messageId);\n      }\n    },\n    toggleReplies: (state, action) => {\n      var _state$channelId2;\n      const {\n        channelId,\n        messageId\n      } = action.payload;\n      const messageIndex = (_state$channelId2 = state[channelId]) === null || _state$channelId2 === void 0 ? void 0 : _state$channelId2.findIndex(m => m.id === messageId);\n      if (messageIndex !== undefined && messageIndex !== -1) {\n        state[channelId][messageIndex].isExpanded = !state[channelId][messageIndex].isExpanded;\n      }\n    },\n    addReaction: (state, action) => {\n      var _state$channelId3;\n      const {\n        channelId,\n        messageId,\n        reaction\n      } = action.payload;\n      const messageIndex = (_state$channelId3 = state[channelId]) === null || _state$channelId3 === void 0 ? void 0 : _state$channelId3.findIndex(m => m.id === messageId);\n      if (messageIndex !== undefined && messageIndex !== -1) {\n        const message = state[channelId][messageIndex];\n        if (!message.reactions) {\n          message.reactions = [];\n        }\n        message.reactions.push(reaction);\n      }\n    },\n    removeReaction: (state, action) => {\n      var _state$channelId4;\n      const {\n        channelId,\n        messageId,\n        userId,\n        emoji\n      } = action.payload;\n      const messageIndex = (_state$channelId4 = state[channelId]) === null || _state$channelId4 === void 0 ? void 0 : _state$channelId4.findIndex(m => m.id === messageId);\n      if (messageIndex !== undefined && messageIndex !== -1) {\n        const message = state[channelId][messageIndex];\n        if (message.reactions) {\n          message.reactions = message.reactions.filter(r => !(r.userId === userId && r.emoji === emoji));\n        }\n      }\n    }\n  }\n});\nexport const {\n  setMessages,\n  addMessage,\n  prependMessages,\n  updateMessage,\n  deleteMessage,\n  toggleReplies,\n  addReaction,\n  removeReaction\n} = messagesSlice.actions;\nexport default messagesSlice.reducer;","map":{"version":3,"names":["createSlice","initialState","messagesSlice","name","reducers","setMessages","state","action","channelId","messages","payload","addMessage","message","push","prependMessages","unshift","updateMessage","_state$channelId","messageId","messageIndex","findIndex","m","id","undefined","deleteMessage","filter","toggleReplies","_state$channelId2","isExpanded","addReaction","_state$channelId3","reaction","reactions","removeReaction","_state$channelId4","userId","emoji","r","actions","reducer"],"sources":["Z:/GAUNTLET/projects/SERMO/sermo-app/frontend/src/store/messages/messagesSlice.ts"],"sourcesContent":["import { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { StoreMessage } from '../../types';\n\ninterface MessagesState {\n  [channelId: string]: StoreMessage[];\n}\n\nconst initialState: MessagesState = {};\n\nconst messagesSlice = createSlice({\n  name: 'messages',\n  initialState,\n  reducers: {\n    setMessages: (state, action: PayloadAction<{ channelId: string; messages: StoreMessage[] }>) => {\n      const { channelId, messages } = action.payload;\n      state[channelId] = messages;\n    },\n    addMessage: (state, action: PayloadAction<{ channelId: string; message: StoreMessage }>) => {\n      const { channelId, message } = action.payload;\n      if (!state[channelId]) {\n        state[channelId] = [];\n      }\n      state[channelId].push(message);\n    },\n    prependMessages: (state, action: PayloadAction<{ channelId: string; messages: StoreMessage[] }>) => {\n      const { channelId, messages } = action.payload;\n      if (!state[channelId]) {\n        state[channelId] = [];\n      }\n      state[channelId].unshift(...messages);\n    },\n    updateMessage: (state, action: PayloadAction<{ channelId: string; messageId: string; message: Partial<StoreMessage> }>) => {\n      const { channelId, messageId, message } = action.payload;\n      const messageIndex = state[channelId]?.findIndex(m => m.id === messageId);\n      if (messageIndex !== undefined && messageIndex !== -1) {\n        state[channelId][messageIndex] = {\n          ...state[channelId][messageIndex],\n          ...message\n        };\n      }\n    },\n    deleteMessage: (state, action: PayloadAction<{ channelId: string; messageId: string }>) => {\n      const { channelId, messageId } = action.payload;\n      if (state[channelId]) {\n        state[channelId] = state[channelId].filter(message => message.id !== messageId);\n      }\n    },\n    toggleReplies: (state, action: PayloadAction<{ channelId: string; messageId: string }>) => {\n      const { channelId, messageId } = action.payload;\n      const messageIndex = state[channelId]?.findIndex(m => m.id === messageId);\n      if (messageIndex !== undefined && messageIndex !== -1) {\n        state[channelId][messageIndex].isExpanded = !state[channelId][messageIndex].isExpanded;\n      }\n    },\n    addReaction: (state, action: PayloadAction<{ channelId: string; messageId: string; reaction: any }>) => {\n      const { channelId, messageId, reaction } = action.payload;\n      const messageIndex = state[channelId]?.findIndex(m => m.id === messageId);\n      if (messageIndex !== undefined && messageIndex !== -1) {\n        const message = state[channelId][messageIndex];\n        if (!message.reactions) {\n          message.reactions = [];\n        }\n        message.reactions.push(reaction);\n      }\n    },\n    removeReaction: (state, action: PayloadAction<{ channelId: string; messageId: string; userId: string; emoji: string }>) => {\n      const { channelId, messageId, userId, emoji } = action.payload;\n      const messageIndex = state[channelId]?.findIndex(m => m.id === messageId);\n      if (messageIndex !== undefined && messageIndex !== -1) {\n        const message = state[channelId][messageIndex];\n        if (message.reactions) {\n          message.reactions = message.reactions.filter(r => \n            !(r.userId === userId && r.emoji === emoji)\n          );\n        }\n      }\n    },\n  },\n});\n\nexport const { \n  setMessages, \n  addMessage, \n  prependMessages, \n  updateMessage, \n  deleteMessage, \n  toggleReplies,\n  addReaction,\n  removeReaction\n} = messagesSlice.actions;\n\nexport default messagesSlice.reducer; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}