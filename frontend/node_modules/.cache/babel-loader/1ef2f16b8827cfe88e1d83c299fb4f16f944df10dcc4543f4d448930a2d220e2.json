{"ast":null,"code":"var _jsxFileName = \"Z:\\\\GAUNTLET\\\\projects\\\\SERMO\\\\sermo-app\\\\frontend\\\\src\\\\components\\\\chat\\\\MessageList\\\\index.tsx\",\n  _s = $RefreshSig$();\nimport React, { forwardRef, useEffect, useRef, useState } from 'react';\nimport styled from 'styled-components';\nimport Message from '../Message';\nimport { addReaction, removeReaction } from '../../../services/api/reactions';\nimport { useDispatch } from 'react-redux';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MessageListContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n  display: flex;\n  flex-direction: column;\n`;\n_c = MessageListContainer;\nconst MessagesWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n  margin-top: auto;\n`;\n_c2 = MessagesWrapper;\nconst LoadingIndicator = styled.div`\n  color: ${props => props.theme.colors.text};\n  text-align: center;\n  padding: 8px;\n  font-family: 'Courier New', monospace;\n`;\n_c3 = LoadingIndicator;\nconst MessageList = /*#__PURE__*/_s(/*#__PURE__*/forwardRef(_c4 = _s((props, ref) => {\n  _s();\n  const {\n    messages,\n    currentUser,\n    isLoadingMore,\n    selectedMessageId,\n    onLoadMore\n  } = props;\n  const containerRef = useRef(null);\n  const [hasScrolledToSelected, setHasScrolledToSelected] = useState(false);\n  const dispatch = useDispatch();\n\n  // Scroll handling logic\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n    const handleScroll = () => {\n      if (container.scrollTop === 0 && !isLoadingMore) {\n        onLoadMore();\n      }\n    };\n    container.addEventListener('scroll', handleScroll);\n    return () => container.removeEventListener('scroll', handleScroll);\n  }, [isLoadingMore, onLoadMore]);\n\n  // Scroll to selected message\n  useEffect(() => {\n    if (selectedMessageId && !hasScrolledToSelected) {\n      const selectedElement = document.getElementById(`message-${selectedMessageId}`);\n      if (selectedElement) {\n        selectedElement.scrollIntoView({\n          behavior: 'smooth',\n          block: 'center'\n        });\n        setHasScrolledToSelected(true);\n      }\n    }\n  }, [selectedMessageId, messages, hasScrolledToSelected]);\n  const handleDeleteMessage = messageId => {\n    console.log('Delete message:', messageId);\n  };\n  const handleToggleReplies = messageId => {\n    console.log('Toggle replies:', messageId);\n  };\n  const handleReply = messageId => {\n    console.log('Reply to message:', messageId);\n  };\n  const handleReactionAdd = async (messageId, emoji) => {\n    try {\n      console.log('Adding reaction to message:', messageId, emoji);\n      await addReaction(messageId, emoji);\n      console.log('Reaction added successfully, waiting for WebSocket event');\n    } catch (error) {\n      console.error('Failed to add reaction:', error);\n    }\n  };\n  const handleReactionRemove = async (messageId, emoji) => {\n    try {\n      console.log('Removing reaction from message:', messageId, emoji);\n      await removeReaction(messageId, emoji);\n      console.log('Reaction removed successfully, waiting for WebSocket event');\n    } catch (error) {\n      console.error('Failed to remove reaction:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(MessageListContainer, {\n    ref: containerRef,\n    children: /*#__PURE__*/_jsxDEV(MessagesWrapper, {\n      children: [isLoadingMore && /*#__PURE__*/_jsxDEV(LoadingIndicator, {\n        children: \"Loading older messages...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }, this), messages.map(message => /*#__PURE__*/_jsxDEV(Message, {\n        id: message.id,\n        content: message.content,\n        sender: message.sender,\n        timestamp: message.timestamp,\n        userId: message.userId,\n        currentUserId: currentUser === null || currentUser === void 0 ? void 0 : currentUser.id,\n        onDelete: () => handleDeleteMessage(message.id),\n        replyCount: message.replyCount,\n        isExpanded: message.isExpanded,\n        onToggleReplies: () => handleToggleReplies(message.id),\n        onReply: () => handleReply(message.id),\n        isReply: message.parentId !== undefined,\n        reactions: message.reactions,\n        onReactionAdd: emoji => handleReactionAdd(message.id, emoji),\n        onReactionRemove: emoji => handleReactionRemove(message.id, emoji)\n      }, message.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 11\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n}, \"lggz+JpRVuAkcv3rN+dbnLRA5kQ=\", false, function () {\n  return [useDispatch];\n})), \"lggz+JpRVuAkcv3rN+dbnLRA5kQ=\", false, function () {\n  return [useDispatch];\n});\n_c5 = MessageList;\nMessageList.displayName = 'MessageList';\nexport default MessageList;\nvar _c, _c2, _c3, _c4, _c5;\n$RefreshReg$(_c, \"MessageListContainer\");\n$RefreshReg$(_c2, \"MessagesWrapper\");\n$RefreshReg$(_c3, \"LoadingIndicator\");\n$RefreshReg$(_c4, \"MessageList$forwardRef\");\n$RefreshReg$(_c5, \"MessageList\");","map":{"version":3,"names":["React","forwardRef","useEffect","useRef","useState","styled","Message","addReaction","removeReaction","useDispatch","jsxDEV","_jsxDEV","MessageListContainer","div","_c","MessagesWrapper","_c2","LoadingIndicator","props","theme","colors","text","_c3","MessageList","_s","_c4","ref","messages","currentUser","isLoadingMore","selectedMessageId","onLoadMore","containerRef","hasScrolledToSelected","setHasScrolledToSelected","dispatch","container","current","handleScroll","scrollTop","addEventListener","removeEventListener","selectedElement","document","getElementById","scrollIntoView","behavior","block","handleDeleteMessage","messageId","console","log","handleToggleReplies","handleReply","handleReactionAdd","emoji","error","handleReactionRemove","children","fileName","_jsxFileName","lineNumber","columnNumber","map","message","id","content","sender","timestamp","userId","currentUserId","onDelete","replyCount","isExpanded","onToggleReplies","onReply","isReply","parentId","undefined","reactions","onReactionAdd","onReactionRemove","_c5","displayName","$RefreshReg$"],"sources":["Z:/GAUNTLET/projects/SERMO/sermo-app/frontend/src/components/chat/MessageList/index.tsx"],"sourcesContent":["import React, { forwardRef, useEffect, useRef, useState } from 'react';\nimport styled from 'styled-components';\nimport Message from '../Message';\nimport { Message as MessageType, User } from '../../../types';\nimport { addReaction, removeReaction } from '../../../services/api/reactions';\nimport { useDispatch } from 'react-redux';\nimport { AppDispatch } from '../../../store';\n\ninterface ExtendedMessage extends MessageType {\n  sender: string;\n  userId: string;\n  timestamp: string;\n  replyCount: number;\n  isExpanded: boolean;\n  parentId?: string;\n  reactions: Array<{\n    id: string;\n    messageId: string;\n    userId: string;\n    emoji: string;\n    createdAt: string;\n  }>;\n}\n\ninterface MessageListProps {\n  messages: ExtendedMessage[];\n  currentUser: User | null;\n  isLoadingMore: boolean;\n  selectedMessageId?: string;\n  onLoadMore: () => void;\n}\n\nconst MessageListContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst MessagesWrapper = styled.div`\n  display: flex;\n  flex-direction: column;\n  gap: 2px;\n  margin-top: auto;\n`;\n\nconst LoadingIndicator = styled.div`\n  color: ${props => props.theme.colors.text};\n  text-align: center;\n  padding: 8px;\n  font-family: 'Courier New', monospace;\n`;\n\nconst MessageList = forwardRef<HTMLDivElement, MessageListProps>((props, ref) => {\n  const { messages, currentUser, isLoadingMore, selectedMessageId, onLoadMore } = props;\n  const containerRef = useRef<HTMLDivElement>(null);\n  const [hasScrolledToSelected, setHasScrolledToSelected] = useState(false);\n  const dispatch = useDispatch<AppDispatch>();\n\n  // Scroll handling logic\n  useEffect(() => {\n    const container = containerRef.current;\n    if (!container) return;\n\n    const handleScroll = () => {\n      if (container.scrollTop === 0 && !isLoadingMore) {\n        onLoadMore();\n      }\n    };\n\n    container.addEventListener('scroll', handleScroll);\n    return () => container.removeEventListener('scroll', handleScroll);\n  }, [isLoadingMore, onLoadMore]);\n\n  // Scroll to selected message\n  useEffect(() => {\n    if (selectedMessageId && !hasScrolledToSelected) {\n      const selectedElement = document.getElementById(`message-${selectedMessageId}`);\n      if (selectedElement) {\n        selectedElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n        setHasScrolledToSelected(true);\n      }\n    }\n  }, [selectedMessageId, messages, hasScrolledToSelected]);\n\n  const handleDeleteMessage = (messageId: string) => {\n    console.log('Delete message:', messageId);\n  };\n\n  const handleToggleReplies = (messageId: string) => {\n    console.log('Toggle replies:', messageId);\n  };\n\n  const handleReply = (messageId: string) => {\n    console.log('Reply to message:', messageId);\n  };\n\n  const handleReactionAdd = async (messageId: string, emoji: string) => {\n    try {\n      console.log('Adding reaction to message:', messageId, emoji);\n      await addReaction(messageId, emoji);\n      console.log('Reaction added successfully, waiting for WebSocket event');\n    } catch (error) {\n      console.error('Failed to add reaction:', error);\n    }\n  };\n\n  const handleReactionRemove = async (messageId: string, emoji: string) => {\n    try {\n      console.log('Removing reaction from message:', messageId, emoji);\n      await removeReaction(messageId, emoji);\n      console.log('Reaction removed successfully, waiting for WebSocket event');\n    } catch (error) {\n      console.error('Failed to remove reaction:', error);\n    }\n  };\n\n  return (\n    <MessageListContainer ref={containerRef}>\n      <MessagesWrapper>\n        {isLoadingMore && (\n          <LoadingIndicator>Loading older messages...</LoadingIndicator>\n        )}\n        {messages.map((message) => (\n          <Message\n            key={message.id}\n            id={message.id}\n            content={message.content}\n            sender={message.sender}\n            timestamp={message.timestamp}\n            userId={message.userId}\n            currentUserId={currentUser?.id}\n            onDelete={() => handleDeleteMessage(message.id)}\n            replyCount={message.replyCount}\n            isExpanded={message.isExpanded}\n            onToggleReplies={() => handleToggleReplies(message.id)}\n            onReply={() => handleReply(message.id)}\n            isReply={message.parentId !== undefined}\n            reactions={message.reactions}\n            onReactionAdd={(emoji) => handleReactionAdd(message.id, emoji)}\n            onReactionRemove={(emoji) => handleReactionRemove(message.id, emoji)}\n          />\n        ))}\n      </MessagesWrapper>\n    </MessageListContainer>\n  );\n});\n\nMessageList.displayName = 'MessageList';\n\nexport default MessageList; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}