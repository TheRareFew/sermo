{"ast":null,"code":"var _jsxFileName = \"Z:\\\\GAUNTLET\\\\projects\\\\SERMO\\\\sermo-app\\\\frontend\\\\src\\\\components\\\\chat\\\\MessageReplies\\\\index.tsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport styled from 'styled-components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport Message from '../Message';\nimport { deleteMessage as deleteMessageAction, setReplies } from '../../../store/messages/messagesSlice';\nimport { deleteMessage as deleteMessageApi, getReplies } from '../../../services/api/chat';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ReplyWrapper = styled.div`\n  margin-left: 24px;\n  border-left: 2px solid ${props => props.theme.colors.border};\n  padding-left: 8px;\n`;\n_c = ReplyWrapper;\nconst MessageReplies = ({\n  parentId\n}) => {\n  _s();\n  const dispatch = useDispatch();\n  const {\n    replies,\n    users,\n    currentUser,\n    activeChannelId\n  } = useSelector(state => ({\n    replies: Object.values(state.messages.messagesByChannel).flat().filter(msg => msg.parentId === parentId),\n    users: state.chat.users,\n    currentUser: state.auth.user,\n    activeChannelId: state.chat.activeChannelId\n  }));\n  useEffect(() => {\n    const loadReplies = async () => {\n      if (!activeChannelId) return;\n      try {\n        const fetchedReplies = await getReplies(parentId);\n        // Transform the replies to match our store format\n        const transformedReplies = fetchedReplies.map(reply => ({\n          id: reply.id.toString(),\n          content: reply.content,\n          channelId: reply.channel_id.toString(),\n          userId: reply.sender_id.toString(),\n          reactions: [],\n          attachments: [],\n          createdAt: reply.created_at,\n          updatedAt: reply.created_at,\n          parentId: parentId,\n          replyCount: 0,\n          isExpanded: false\n        }));\n        dispatch(setReplies({\n          channelId: activeChannelId,\n          messageId: parentId,\n          replies: transformedReplies\n        }));\n      } catch (error) {\n        console.error('Error loading replies:', error);\n      }\n    };\n    loadReplies();\n  }, [parentId, activeChannelId, dispatch]);\n  const handleDelete = async messageId => {\n    if (!activeChannelId) return;\n    try {\n      await deleteMessageApi(messageId);\n      dispatch(deleteMessageAction({\n        channelId: activeChannelId,\n        messageId\n      }));\n    } catch (error) {\n      console.error('Error deleting reply:', error);\n    }\n  };\n  const handleToggleReplies = () => {\n    // No-op for replies\n  };\n  const handleReply = () => {\n    // No-op for replies\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: replies.map(reply => {\n      var _users$reply$userId;\n      return /*#__PURE__*/_jsxDEV(ReplyWrapper, {\n        children: /*#__PURE__*/_jsxDEV(Message, {\n          content: reply.content,\n          sender: ((_users$reply$userId = users[reply.userId]) === null || _users$reply$userId === void 0 ? void 0 : _users$reply$userId.username) || reply.userId,\n          timestamp: reply.createdAt,\n          userId: reply.userId,\n          currentUserId: currentUser === null || currentUser === void 0 ? void 0 : currentUser.id,\n          onDelete: () => handleDelete(reply.id),\n          replyCount: 0,\n          isExpanded: false,\n          onToggleReplies: handleToggleReplies,\n          onReply: handleReply,\n          isReply: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this)\n      }, reply.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 9\n      }, this);\n    })\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 5\n  }, this);\n};\n_s(MessageReplies, \"rs3c9HhD7XmndDQLccs/0ieaV+g=\", false, function () {\n  return [useDispatch, useSelector];\n});\n_c2 = MessageReplies;\nexport default MessageReplies;\nvar _c, _c2;\n$RefreshReg$(_c, \"ReplyWrapper\");\n$RefreshReg$(_c2, \"MessageReplies\");","map":{"version":3,"names":["React","useEffect","styled","useSelector","useDispatch","Message","deleteMessage","deleteMessageAction","setReplies","deleteMessageApi","getReplies","jsxDEV","_jsxDEV","ReplyWrapper","div","props","theme","colors","border","_c","MessageReplies","parentId","_s","dispatch","replies","users","currentUser","activeChannelId","state","Object","values","messages","messagesByChannel","flat","filter","msg","chat","auth","user","loadReplies","fetchedReplies","transformedReplies","map","reply","id","toString","content","channelId","channel_id","userId","sender_id","reactions","attachments","createdAt","created_at","updatedAt","replyCount","isExpanded","messageId","error","console","handleDelete","handleToggleReplies","handleReply","children","_users$reply$userId","sender","username","timestamp","currentUserId","onDelete","onToggleReplies","onReply","isReply","fileName","_jsxFileName","lineNumber","columnNumber","_c2","$RefreshReg$"],"sources":["Z:/GAUNTLET/projects/SERMO/sermo-app/frontend/src/components/chat/MessageReplies/index.tsx"],"sourcesContent":["import React, { useEffect } from 'react';\nimport styled from 'styled-components';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { StoreMessage, RootState } from '../../../types';\nimport Message from '../Message';\nimport { deleteMessage as deleteMessageAction, setReplies } from '../../../store/messages/messagesSlice';\nimport { deleteMessage as deleteMessageApi, getReplies } from '../../../services/api/chat';\n\ninterface MessageRepliesProps {\n  parentId: string;\n}\n\nconst ReplyWrapper = styled.div`\n  margin-left: 24px;\n  border-left: 2px solid ${props => props.theme.colors.border};\n  padding-left: 8px;\n`;\n\nconst MessageReplies: React.FC<MessageRepliesProps> = ({ parentId }) => {\n  const dispatch = useDispatch();\n  const { replies, users, currentUser, activeChannelId } = useSelector((state: RootState) => ({\n    replies: Object.values(state.messages.messagesByChannel)\n      .flat()\n      .filter((msg: StoreMessage) => msg.parentId === parentId),\n    users: state.chat.users,\n    currentUser: state.auth.user,\n    activeChannelId: state.chat.activeChannelId\n  }));\n\n  useEffect(() => {\n    const loadReplies = async () => {\n      if (!activeChannelId) return;\n      \n      try {\n        const fetchedReplies = await getReplies(parentId);\n        // Transform the replies to match our store format\n        const transformedReplies = fetchedReplies.map(reply => ({\n          id: reply.id.toString(),\n          content: reply.content,\n          channelId: reply.channel_id.toString(),\n          userId: reply.sender_id.toString(),\n          reactions: [],\n          attachments: [],\n          createdAt: reply.created_at,\n          updatedAt: reply.created_at,\n          parentId: parentId,\n          replyCount: 0,\n          isExpanded: false\n        }));\n        \n        dispatch(setReplies({\n          channelId: activeChannelId,\n          messageId: parentId,\n          replies: transformedReplies\n        }));\n      } catch (error) {\n        console.error('Error loading replies:', error);\n      }\n    };\n\n    loadReplies();\n  }, [parentId, activeChannelId, dispatch]);\n\n  const handleDelete = async (messageId: string) => {\n    if (!activeChannelId) return;\n    \n    try {\n      await deleteMessageApi(messageId);\n      dispatch(deleteMessageAction({ channelId: activeChannelId, messageId }));\n    } catch (error) {\n      console.error('Error deleting reply:', error);\n    }\n  };\n\n  const handleToggleReplies = () => {\n    // No-op for replies\n  };\n\n  const handleReply = () => {\n    // No-op for replies\n  };\n\n  return (\n    <div>\n      {replies.map((reply) => (\n        <ReplyWrapper key={reply.id}>\n          <Message\n            content={reply.content}\n            sender={users[reply.userId]?.username || reply.userId}\n            timestamp={reply.createdAt}\n            userId={reply.userId}\n            currentUserId={currentUser?.id}\n            onDelete={() => handleDelete(reply.id)}\n            replyCount={0}\n            isExpanded={false}\n            onToggleReplies={handleToggleReplies}\n            onReply={handleReply}\n            isReply={true}\n          />\n        </ReplyWrapper>\n      ))}\n    </div>\n  );\n};\n\nexport default MessageReplies; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}